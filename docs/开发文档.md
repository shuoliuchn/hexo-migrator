数据库博客生成 Hexo 博客文件思路：

1. 生成 front-matter 头部
   1. 查询数据库，生成 front-matter 所需数据组成的字典
   2. 调用 yaml，生成 yaml 字符串
   3. 组装成为 front-matter 头部，就是用 --- 把 yaml 字符串包裹起来
   4. 测试中文写入情况，如果正常写入则无所谓，如果不正常要考虑解决方案。
2. 组装，很简单，将 front-matter 和正文文本拼接。注意 `\n`  的使用
3. 判断文章**目标路径是否存在**，若不存在，则创建，并写入文件；若存在，判断已存在的文件和要写入的**内容是否相同**，若相同则跳过，若不相同，则写入（个人觉得，写入比读取更伤硬盘，此举为了避免频繁写入数据）。
4. 到上步就已经完成任务，只是补充说明一句，静态文件在导入原博客到数据库中的时候就已经转移好了，这里不用管。

完成内容：

1. 字数统计，包括中文和字符总数的统计
2. 数据库批量自动生成 Hexo 友好型 md 文件

欠缺内容：

1. 本脚本的 readme，包括 Hexo 的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
   - 不要在行内使用连续双花括号，要用的话至少在中间加上一个空格，像这样：`{{ }}`
2. 增加自定义 yaml front latter 的选项（暂时用不上，看需求，待定）
3. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库
4. 前端页面的整理优化
5. 自定义菜单，自定义功能（暂时用不上，一个人也写不过来，待定）

### 2020-03-11 分支：dev 版本：9cdb926

开发人员：刘硕

完成内容：

1. 完成了原始博客处理逻辑和功能，可将原始博客导入至数据库
2. 解决了花括号迁移的问题
3. 完成了原始博客图片迁移功能

bug 记录：

虽然解决了大部分日常使用中的花括号问题，但是对于一对连续的花括号，还是会有 bug，也就是说：

```jinja2
{{}}
会显示成：
{% raw %}{{{% endraw %{% raw %}}}{% endraw %}}
```

这个 bug 是因为左边括号替换后，endraw 的右花括号会有左边双花括号重合。暂时没找到简单的解决办法。

欠缺内容：

1. 字数统计，很简单，在首页调用数据库一循环就行了，封装成方法，别在视图中直接写
2. 数据库批量自动生成 Hexo 友好型 md 文件
3. 本脚本的 readme，包括 Hexo 的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
   - 不要在行内使用连续双花括号，要用的话至少在中间加上一个空格，像这样：`{{ }}`
4. 增加自定义 yaml front latter 的选项（暂时用不上，看需求，待定）
5. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库
6. 前端页面的整理优化
7. 自定义菜单，自定义功能（暂时用不上，一个人也写不过来，待定）

### 2020-03-10 分支：dev 版本：21b7b39

开发人员：刘硕

原始博客处理逻辑

1. 获取文件路径信息，分析出**相对路径**和**分类**，初步判断是否**置顶**，准备存入数据库
2. 打开文件拿到正文文本，获取**标题**，准备存入数据库
3. 以代码块分段，将分为代码块部分和正常内容部分。代码块部分是安全的，Hexo 不会跟 Typera 有任何差异，也不会有报错，所以我们也不对这部分内容进行任何替换。正常内容部分是我们替换集中的位置。
   1. 清除内容部分中的 `\n[TOC]\n`
   2. 判断是否需要目录 toc（有的主题需要这个参数，有的不需要，设置上总不错的）
   3. 替换博客内容中的特殊花括号，首先替换 `{% %}`，其余顺序任意
   4. 替换博客中的图片，这个步骤一定要在替换花括号的步骤之后进行
   5. 替换博客中的站内相对链接

完成内容：

1. 博客、分类和标签的删除与恢复（假删除）和彻底删除
2. 主要是思路整理，还有流程图制作

欠缺内容：

1. 使用 Typera 写的原始版本博客批量自动导入数据库，并完成静态文件的转移
3. 数据库批量自动生成 Hexo 友好型 md 文件
4. 本脚本的 readme，包括 Hexo 的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
   - 不能用行内注释，也就是一对反引号包裹双花括号之类的特殊内容
   - 如果非要输入，尽量放在代码块，也就是三对反引号之中
5. 增加自定义 yaml front latter 的选项
6. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库
7. 解决花括号难题
8. 前端页面的整理优化
9. 自定义菜单，自定义功能

附，生成 hexo 友好型文档流程图（原版博客处理流程图）：

![生成hexo友好型文档流程图](%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3.assets/%E7%94%9F%E6%88%90hexo%E5%8F%8B%E5%A5%BD%E5%9E%8B%E6%96%87%E6%A1%A3%E6%B5%81%E7%A8%8B%E5%9B%BE.png)

### 2020-03-09 分支：dev 版本：3df7c1d

开发者：刘硕

完成内容：

博客内容、分类、标签的增删改操作

欠缺内容：

1. 数据库中博客数据和分类、标签的删除
2. 使用 Typera 写的原始版本博客批量自动导入数据库，并完成静态文件的转移
3. 数据库批量自动生成 Hexo 友好型 md 文件
4. 本脚本的 readme，包括 Hexo 的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
   - 不能用行内注释，也就是一对反引号包裹双花括号之类的特殊内容
   - 如果非要输入，尽量放在代码块，也就是三对反引号之中
5. 增加自定义 yaml front latter 的选项
6. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库
7. 解决花括号难题
8. 前端页面的整理优化

### 2020-03-08 分支：dev 版本：850a7fc

开发者：刘硕

完成内容：

1. 完成了 Django 框架的构建，各个组件应用已经调通
2. 完成了从现有博客文件导入数据库功能。
   - 因为用无可视化界面版本生成过博客，有博客文件。这些文件没有出现在数据库中，但是它们的 Front Matter 中可能会有有用的东西，比如描述信息，比如特别的设置（mathjax 之类的）。如果挨个找，显然是不现实的。所以首先实现了旧博客的导入功能
   - 不光博客信息导入数据库，还实现了图片批量转移。就博客文件中的图片会自动转移到目标文件夹中

欠缺内容：

1. 数据库中博客数据的增删改查
2. 使用 Typera 写的原始版本博客批量自动导入数据库，并完成静态文件的转移
3. 数据库批量自动生成 Hexo 友好型 md 文件
4. 本脚本的 readme，包括 Hexo 的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
   - 不能用行内注释，也就是一对反引号包裹双花括号之类的特殊内容
   - 如果非要输入，尽量放在代码块，也就是三对反引号之中
5. 增加自定义 yaml front latter 的选项
6. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库

附，从现有符合 Hexo 格式的成型博客导入功能的原型图和流程图（目标路径用于保存图片）：

![hexo migrator 从现有博客中导入](%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3.assets/hexo%20migrator%20%E4%BB%8E%E7%8E%B0%E6%9C%89%E5%8D%9A%E5%AE%A2%E4%B8%AD%E5%AF%BC%E5%85%A5.png)

### 2020-03-07 分支：master 版本：a45f89a

开发人员：刘硕

这是第一个版本，实现了后端主要逻辑，但是没有前端的 UI 界面。能用，但是用起来很难受。

主要为了解决这个问题，抽时间开发一个基于 Django 框架的，有 Web 界面的小项目。

欠缺功能：

1. （已解决）yaml 标题的优化，包括重新修改生成逻辑，使用字典 items 方法，
   获取字符串的key，value字符串，然后进行拼接
   获取内容字典，然后格式化生成标题
2. （已解决）增加desc描述的增加功能，给需要修改的和新增的文件提示修改desc
   若原文件有desc，将其输出，询问用户是否修改
   若原文件没有desc，问用户是否需要添加描述内容
       若需要，则添加
       若不需要，则跳过，并且不生成desc
3. 本脚本的readme，包括hexo的使用方法
   比如，每个文章都必须要有标题，标题需要是一级或二级
       不能用行内注释，也就是一对反引号包裹双花括号之类的特殊内容
       如果非要输入，尽量放在代码块，也就是三对反引号之中
4. （已解决）字数统计功能，包括汉字总数和字符总数的统计
5. （已解决）修改日期和创建日期区分
6. （已解决）优化目录检索模式，不要单单检索文件名了，要用相对路径检索，这样可避免重名带来的麻烦
7. 代码结构优化，提高可读性
8. 增加自定义 yaml front latter 的选项
9. 图形界面
10. 自动化操作，比如自动执行 git 命令，自动上传至远程仓库

